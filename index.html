<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simple Explorer</title>
    <link rel="stylesheet" href="./assets/styles.css">
    <script src="./assets/simple-explorer.js"></script>
</head>
<body>
    <div id="explorer" class="se_explorer">
        <div class="se_explorer_toolbar">
            <div class="se_explorer_navtools">
                <button class="se_explorer_navtool_back disabled"></button>
                <button class="se_explorer_navtool_forward"></button>
                <button class="se_explorer_navtool_history"></button>
                <button class="se_explorer_navtool_up"></button>
            </div>
            <div class="se_explorer_path_wrap">
                <div class="se_explorer_path_icon"></div>
                <div class="se_explorer_path_segments_scroll_wrap">
                    <div class="se_explorer_path_segments">
                        <div class="se_explorer_path_segment">
                            <button class="se_explorer_path_name">htdocs (/)</button>
                            <button class="se_explorer_path_opts"></button>
                        </div>
                        <div class="se_explorer_path_segment">
                            <button class="se_explorer_path_name">dashboard</button>
                            <button class="se_explorer_path_opts"></button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="se_explorer_body">
            <table class="se_explorer_items_table">
                <thead class="se_explorer_items_header">
                    <tr>
                        <th class="se_explorer_items_header_col">
                            <button class="se_explorer_items_header_col_text">Action</button>
                        </th>
                        <th class="se_explorer_items_header_col flex-1 align_left">
                            <button class="se_explorer_items_header_col_text">Name</button>
                        </th>
                        <th class="se_explorer_items_header_col">
                            <button class="se_explorer_items_header_col_text">Mode</button>
                        </th>
                        <th class="se_explorer_items_header_col">
                            <button class="se_explorer_items_header_col_text">Owner</button>
                        </th>
                        <th class="se_explorer_items_header_col">
                            <button class="se_explorer_items_header_col_text">Group</button>
                        </th>
                        <th class="se_explorer_items_header_col">
                            <button class="se_explorer_items_header_col_text">Size</button>
                        </th>
                        <th class="se_explorer_items_header_col">
                            <button class="se_explorer_items_header_col_text">Modified</button>
                        </th>
                    </tr>
                </thead>
                <tbody class="se_explorer_items_scroll_wrap">
                    <tr class="se_explorer_items_message se_explorer_hidden"><td colspan="7">Loading...</td></tr>
                    <tr class="se_explorer_item_wrap">
                        <td class="se_explorer_item_col"></td>
                        <td class="se_explorer_item_col">
                            <div class="se_explorer_item_name">
                                <div class="se_explorer_item_name_icon se_explorer_item_name_icon_folder"></div>
                                <div class="se_explorer_item_name_text">Folder</div>
                            </div>
                        </td>
                        <td class="se_explorer_item_col text-muted">drwxrwxr-x</td>
                        <td class="se_explorer_item_col text-muted">ryomario (1000)</td>
                        <td class="se_explorer_item_col text-muted">www-data (33)</td>
                        <td class="se_explorer_item_col text-muted">-</td>
                        <td class="se_explorer_item_col text-muted">11/8/2023 8:43 AM</td>
                    </tr>
                    <tr class="se_explorer_item_wrap">
                        <td class="se_explorer_item_col"></td>
                        <td class="se_explorer_item_col">
                            <div class="se_explorer_item_name">
                                <div class="se_explorer_item_name_icon se_explorer_item_name_icon_file se_explorer_item_name_icon_ext_h" data-ext="HTML"></div>
                                <div class="se_explorer_item_name_text">File</div>
                            </div>
                        </td>
                        <td class="se_explorer_item_col text-muted">drwxrwxr-x</td>
                        <td class="se_explorer_item_col text-muted">ryomario (1000)</td>
                        <td class="se_explorer_item_col text-muted">www-data (33)</td>
                        <td class="se_explorer_item_col text-muted">500KB</td>
                        <td class="se_explorer_item_col text-muted">11/8/2023 8:43 AM</td>
                    </tr>
                </tbody>
            </table>
        </div>
        <div class="se_explorer_footer">
            <div class="se_explorer_statusbar">
                <div class="se_explorer_statusbar_text_wrap">
                    <div class="se_explorer_statusbar_text_segment">30 items</div>
                    <div class="se_explorer_statusbar_text_segment">2 items selected (300KB)</div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const dummy_api_response = {
            "": {
                "success": true,
                "entries": [
                    {
                        "id": "Empty Folder",
                        "name": "Empty Folder",
                        "type": "folder",
                        "hash": "91f604098a4b7d853ca7c45208bad451",
                        "link": "/Empty Folder",
                        "mode": "drwxrwxr-x",
                        "owner": "ryomario (1000)",
                        "group": "ryomario (1000)",
                        "modified": "14/11/2023 06:44",
                        "items_count": 0
                    },
                    {
                        "id": "Only 1 file",
                        "name": "Only 1 file",
                        "type": "folder",
                        "hash": "ea5e37bbe4d1f418ae112f4595564474",
                        "link": "/Only 1 file",
                        "mode": "drwxrwxr-x",
                        "owner": "ryomario (1000)",
                        "group": "ryomario (1000)",
                        "modified": "12/02/2024 04:14",
                        "items_count": 1
                    },
                    {
                        "id": "Error Folder",
                        "name": "Error Folder",
                        "type": "folder",
                        "hash": "3f3f0e9dd022e4ce0724d2b09e9b2ff7",
                        "link": "/Error Folder",
                        "mode": "drwxrwxr-x",
                        "owner": "root (0)",
                        "group": "root (0)",
                        "modified": "06/02/2024 07:43",
                        "items_count": 0
                    },
                    {
                        "id": "Server Error Folder",
                        "name": "Server Error Folder",
                        "type": "folder",
                        "hash": "3f3f0e9dd022e4ce0724d2b09e9b2ff7",
                        "link": "/Error Folder",
                        "mode": "drwxrwxr-x",
                        "owner": "ryomario (1000)",
                        "group": "root (0)",
                        "modified": "06/05/2024 09:03",
                        "items_count": 0
                    },
                    {
                        "id": "file.php",
                        "name": "file.php",
                        "type": "file",
                        "hash": "016e87948b2b773a918ab682e431aeb0",
                        "link": "/file.php",
                        "mode": "-rw-rw-r--",
                        "owner": "ryomario (1000)",
                        "group": "www-data (33)",
                        "modified": "04/03/2024 08:20",
                        "size": 197728
                    },
                    {
                        "id": "index.php",
                        "name": "index.php",
                        "type": "file",
                        "hash": "1cc48bbb739021a1ad45898d6f33500f",
                        "link": "/index.php",
                        "mode": "-rw-r--r--",
                        "owner": "ryomario (1000)",
                        "group": "www-data (33)",
                        "modified": "14/06/2024 04:43",
                        "size": 484
                    },
                    {
                        "id": "style.css",
                        "name": "style.css",
                        "type": "file",
                        "hash": "591d70802d14ebfab6f6dd6dbe9e852d",
                        "link": "/style.css",
                        "mode": "-rw-r--r--",
                        "owner": "root (0)",
                        "group": "www-data (33)",
                        "modified": "27/02/2017 09:36",
                        "size": 177
                    },
                    {
                        "id": "applications.html",
                        "name": "applications.html",
                        "type": "file",
                        "hash": "50bc5bc558b8af2cfa44cbde4f1c4e9b",
                        "link": "/applications.html",
                        "mode": "-rw-r--r--",
                        "owner": "root (0)",
                        "group": "www-data (33)",
                        "modified": "27/02/2017 09:36",
                        "size": 3607
                    }
                ]
            },
            '/Empty Folder': {
                "success": true,
                "entries": []
            },
            '/Only 1 file': {
                "success": true,
                "entries": [
                    {
                        "id": "index.html",
                        "name": "index.html",
                        "type": "file",
                        "hash": "50bc5bc558b8af2cfa44cbde4f1c4e9b",
                        "link": "/index.html",
                        "mode": "-rw-r--r--",
                        "owner": "ryomario (1000)",
                        "group": "www-data (33)",
                        "modified": "27/02/2018 19:06",
                        "size": 5607
                    }
                ]
            },
            '/Error Folder': {
                "success": false,
                "error": "Permission denied."
            },
        }

        new SimpleExplorer(document.getElementById('explorer'),{
            messagetimeout: 2000,
            displayunits: 'iec_windows',
            initpath: [
                [ '', 'htdocs (/)' ]
            ],
            // doubleclickdelay: 10000,
            langmap: {
                'Action': '',
                'Name': '',
                'Mode': '',
                'Owner': '',
                'Group': '',
                'Size': '',
                'Modified': '',
                '{0} items': '',
                'Loading...': 'Waiting for 1 second . . .',
                'This folder is empty.': ''
            },
            onrefresh: function(folder, required) {
                const path = folder.GetPathIDs().join('/');
                var $this = this;

                setTimeout(() => {
                    const data = dummy_api_response[path];

                    if(!data && required){
                        $this.SetNamedStatusBarText('folder', 'Failed to load folder.  Server error.');
                        return;
                    }

                    if (data.success)
                    {
                        if ($this.IsMappedFolder(folder))  folder.SetEntries(data.entries);
                    }
                    else if (required)
                    {
                        $this.SetNamedStatusBarText('folder', $this.EscapeHTML('Failed to load folder.  ' + data.error));
                    }
                }, 1000);
            },
            onopenfile: function(folder, entry) {
                alert(entry.name + ' opened!');
            },
            onitemcontextmenucreate: function(entry, elem) {
                return [
                    {id: 'custom', name: 'Custom option'},
                ]
            },
            onitemcontextmenuselect: function(id, elem, entry) {
                switch (id) {
                    case 'custom': alert("Custom option clicked!"); break;
                }
            },
        });
    </script>
</body>
</html>